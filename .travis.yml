os:
  - linux

language: cpp

sudo: required
dist: xenial

before_install:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
      sudo add-apt-repository --yes ppa:ubuntu-toolchain-r/test;
      wget https://github.com/glfw/glfw/releases/download/3.1.1/glfw-3.1.1.zip;
      sudo apt-get update;
      sudo apt-get-repository ppa:ubuntu-toolchain-r/test;
      sudo apt-get update;
      sudo apt-get install gcc-5 g++-5;
      sudo update-alternatives --install /usr/bin/gcc gcc /usr/bin/gcc-5 60 --slave /usr/bin/g++ g++ /usr/bin/g++-5;
    fi

install:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
      sudo apt-get install -qq build-essential xorg-dev libglu1-mesa-dev libglew-dev libglm-dev;
      sudo apt-get install -qq cmake;
      sudo apt-get install -qq libusb-1.0-0-dev ;
      sudo apt-get install -qq libgtk-3-dev ;
      sudo apt-get install python python-dev ;

      cmake --version;

      unzip glfw-3.1.1.zip;
      cd glfw-3.1.1;
      sudo cmake -G "Unix Makefiles" -DBUILD_SHARED_LIBS=ON;
      sudo make;
      sudo make install;
      cd ..;
    fi
script:
  - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
      uname -a;
      mkdir build;
      cd build;
      cmake .. -DBUILD_EXAMPLES:BOOL=true -DBUILD_PYTHON_BINDINGS:BOOL=true;
      make -J;
      sudo make install;
      export LRS_LOG_LEVEL="DEBUG";
      wget http://realsense-hw-public.s3.amazonaws.com/rs-tests/awgc4;
      ./unit-tests/live-test from awgc4 -d yes;
    fi
